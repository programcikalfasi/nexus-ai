{% load i18n %}
<div class="card h-100" id="item-card-{{ item.id }}" style="position: relative; overflow: hidden;">
    <div class="card-body d-flex flex-column" style="padding: 1.75rem;">
        <div class="d-flex justify-content-between align-items-start mb-3">
            <span class="badge bg-info" style="font-size: 0.75rem; text-transform: uppercase;">
                {{ item.source }}
            </span>
            {% if item.ai_analysis %}
            <span style="font-size: 1.5rem;">âœ¨</span>
            {% endif %}
        </div>

        <h5 class="card-title"
            style="font-weight: 700; font-size: 1.25rem; line-height: 1.4; margin-bottom: 1rem; min-height: 3.5rem; color: #ffffff;">
            {{ item.title|truncatewords:15 }}
        </h5>

        <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer" class="small mb-3 text-truncate d-block"
            style="text-decoration: none; transition: color 0.2s; color: #a5b4fc; opacity: 0.9;">
            ðŸ”— {{ item.url|truncatechars:50 }}
        </a>

        {% if item.ai_analysis %}
        <div class="mt-auto">
            <div class="d-flex gap-2 mb-3 flex-wrap">
                <span class="badge bg-success"
                    style="flex: 1; text-align: center; padding: 0.75rem; font-size: 0.875rem;">
                    ðŸ”¥ {% trans "Hype" %}: {{ item.ai_analysis.hype_score }}/100
                </span>
                <span class="badge bg-warning text-dark"
                    style="flex: 1; text-align: center; padding: 0.75rem; font-size: 0.875rem;">
                    ðŸ“Š {{ item.ai_analysis.difficulty }}
                </span>
            </div>

            <p class="card-text small mb-3" style="color: #e4e4e7; line-height: 1.7; font-size: 0.95rem;">
                {{ item.ai_analysis.summary|truncatewords:25 }}
            </p>

            {% if item.ai_analysis.tech_stack %}
            <div class="mb-3 d-flex gap-1 flex-wrap">
                {% for tech in item.ai_analysis.tech_stack|slice:":3" %}
                <span class="badge bg-light" style="font-size: 0.75rem; padding: 0.5rem 0.875rem;">
                    {{ tech }}
                </span>
                {% endfor %}
            </div>
            {% endif %}

            <a href="{% url 'start_chat' item.id %}" class="btn btn-dark w-100"
                style="font-weight: 600; padding: 0.875rem;">
                ðŸ’¬ {% trans "Chat with this" %}
            </a>
        </div>
        {% else %}
        <div class="mt-auto">
            <button hx-post="{% url 'analyze_item' item.id %}" hx-target="#item-card-{{ item.id }}" hx-swap="outerHTML"
                class="btn btn-outline-primary w-100" style="font-weight: 600; padding: 0.875rem; font-size: 1rem;">
                <span style="margin-right: 0.5rem;">ðŸ¤–</span> {% trans "Analyze with AI" %}
            </button>
        </div>
        {% endif %}
    </div>

    {% if item.ai_analysis %}
    <div
        style="position: absolute; top: 0; right: 0; width: 100px; height: 100px; background: var(--primary-gradient); opacity: 0.05; border-radius: 0 24px 0 100%;">
    </div>
    {% endif %}
</div>